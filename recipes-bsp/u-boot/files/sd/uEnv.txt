bootenv_cmd=run defargs; run load_fpga; run load_kernel; setenv initrd_optional_addr ${initrd_addr}; run load_initrd || run use_sdrootfs; run boot_kernel
use_sdrootfs=setenv initrd_optional_addr -; setenv sdrootfs root=/dev/mmcblk${sdbootdev}p4
defargs=setenv bootargs console=ttyPS0,115200n8 rw earlycon ${sdrootfs}
set_fdt_file=setenv fdt_file ${machine}-system.dtb
initrd_file=initrd
fpga_file=xilinx.bit
fpga_addr=80000
load_fpga=echo Loading FPGA if exists...; load mmc ${sdbootdev} ${fpga_addr} ${fpga_file} && fpga loadb 0 ${fpga_addr} ${filesize}
load_kernel=echo Loading Linux...; load mmc ${sdbootdev} ${kernel_addr} Image; run set_fdt_file; load mmc ${sdbootdev} ${fdt_addr} ${fdt_file}
load_initrd=echo Loading initrd if exists...; load mmc ${sdbootdev} ${initrd_addr} ${initrd_file}
boot_kernel=booti ${kernel_addr} ${initrd_optional_addr} ${fdt_addr}
